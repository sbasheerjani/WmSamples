<?xml version="1.0" encoding="UTF-8"?>

<FLOW VERSION="3.0" CLEANUP="true">
  <COMMENT>This step is performed to register the content type "application/ias" with the webMethods Integration Server</COMMENT>

  <!-- nodes -->

<INVOKE TIMEOUT="" SERVICE="sample.contentHandler:registerContentHandler" VALIDATE-IN="$none" VALIDATE-OUT="$none">
  <COMMENT>This step is performed to register the content type "application/ias" with the webMethods Integration Server</COMMENT>

  <!-- nodes -->

<MAP MODE="INPUT">
</MAP>

<MAP MODE="OUTPUT">
</MAP>
</INVOKE>

<MAP TIMEOUT="" MODE="STANDALONE">
  <COMMENT>Convert the set value input string to a byte stream (uses transformer)</COMMENT>
  <MAPTARGET>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPTARGET>
  <MAPSOURCE>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPSOURCE>

  <!-- nodes -->

<MAPSET NAME="Setter" OVERWRITE="true" VARIABLES="false" FIELD="/Input;1;0">
  <DATA ENCODING="XMLValues" I18N="true">

<Values version="2.0">
  <value name="xml">String that is being posted to serviceToPostTo:</value>
  <record name="type" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_name">inputString</value>
    <value name="field_type">string</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
  </record>
</Values>
</DATA>
</MAPSET>
</MAP>

<INVOKE TIMEOUT="" SERVICE="pub.client:http" VALIDATE-IN="$none" VALIDATE-OUT="$none">
  <COMMENT>Send the input string to a service on your local machine (sample.contentHandler.test:serviceToPostTo)</COMMENT>

  <!-- nodes -->

<MAP MODE="INPUT">
  <MAPTARGET>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPTARGET>
  <MAPSOURCE>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPSOURCE>

  <!-- nodes -->

<MAPSET NAME="Setter" OVERWRITE="true" VARIABLES="false" FIELD="/url;1;0">
  <DATA ENCODING="XMLValues" I18N="true">

<Values version="2.0">
  <value name="xml">http://localhost:5555/invoke/sample.contentHandler.test/serviceToPostTo</value>
  <record name="type" javaclass="com.wm.util.Values">
    <value name="node_type">unknown</value>
    <value name="field_name">url</value>
    <value name="field_type">string</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
  </record>
</Values>
</DATA>
</MAPSET>

<MAPSET NAME="Setter" OVERWRITE="true" VARIABLES="false" FIELD="/method;1;0">
  <DATA ENCODING="XMLValues" I18N="true">

<Values version="2.0">
  <value name="xml">post</value>
  <record name="type" javaclass="com.wm.util.Values">
    <value name="node_type">unknown</value>
    <value name="field_name">method</value>
    <value name="field_type">string</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <array name="field_options" type="value" depth="1">
      <value>get</value>
      <value>post</value>
      <value>head</value>
      <value>put</value>
      <value>delete</value>
      <value>options</value>
      <value>trace</value>
    </array>
  </record>
</Values>
</DATA>
</MAPSET>

<MAPSET NAME="Setter" OVERWRITE="true" VARIABLES="false" FIELD="/auth;2;0/user;1;0">
  <DATA ENCODING="XMLValues" I18N="true">

<Values version="2.0">
  <value name="xml">Administrator</value>
  <record name="type" javaclass="com.wm.util.Values">
    <value name="node_type">unknown</value>
    <value name="field_name">user</value>
    <value name="field_type">string</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
  </record>
</Values>
</DATA>
</MAPSET>

<MAPSET NAME="Setter" OVERWRITE="true" VARIABLES="false" FIELD="/auth;2;0/pass;1;0">
  <DATA ENCODING="XMLValues" I18N="true">

<Values version="2.0">
  <value name="xml">manage</value>
  <record name="type" javaclass="com.wm.util.Values">
    <value name="node_type">unknown</value>
    <value name="field_name">pass</value>
    <value name="field_type">string</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
  </record>
</Values>
</DATA>
</MAPSET>

<MAPSET NAME="Setter" OVERWRITE="true" VARIABLES="false" FIELD="/headers;2;0">
  <DATA ENCODING="XMLValues" I18N="true">

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="content-type">YourContent/type</value>
  </record>
  <record name="type" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_name">headers</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">true</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</DATA>
</MAPSET>

<MAPCOPY NAME="Link" FROM="/Input;1;0" TO="/data;2;0/string;1;0">
</MAPCOPY>
</MAP>

<MAP MODE="OUTPUT">
  <MAPTARGET>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPTARGET>
  <MAPSOURCE>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPSOURCE>

  <!-- nodes -->

<MAPDELETE NAME="Dropper" FIELD="/url;1;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/method;1;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/inputToHTTP;3;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/data;2;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/auth;2;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/headers;2;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/encodedURL;1;0">
</MAPDELETE>
</MAP>
</INVOKE>

<INVOKE TIMEOUT="" SERVICE="pub.string:bytesToString" VALIDATE-IN="$none" VALIDATE-OUT="$none">
  <COMMENT>Parse the results.</COMMENT>

  <!-- nodes -->

<MAP MODE="INPUT">
  <MAPTARGET>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPTARGET>
  <MAPSOURCE>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPSOURCE>

  <!-- nodes -->

<MAPCOPY NAME="Link" FROM="/body;2;0/bytes;3;0" TO="/bytes;3;0">
</MAPCOPY>
</MAP>

<MAP MODE="OUTPUT">
  <MAPTARGET>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPTARGET>
  <MAPSOURCE>

<Values version="2.0">
  <record name="xml" javaclass="com.wm.util.Values">
    <value name="node_type">record</value>
    <value name="field_type">record</value>
    <value name="field_dim">0</value>
    <value name="field_opt">false</value>
    <list name="rec_fields">
    </list>
    <value name="rec_closed">false</value>
  </record>
</Values>
</MAPSOURCE>

  <!-- nodes -->

<MAPCOPY NAME="Link" FROM="/string;1;0" TO="/Output;1;0">
</MAPCOPY>

<MAPDELETE NAME="Dropper" FIELD="/header;2;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/body;2;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/bytes;3;0">
</MAPDELETE>

<MAPDELETE NAME="Dropper" FIELD="/string;1;0">
</MAPDELETE>
</MAP>
</INVOKE>
</FLOW>
